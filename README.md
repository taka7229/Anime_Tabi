# アニメ聖地観光支援SPARQLシステム

## 概要
RDFデータを活用した、アニメ聖地巡礼と周辺施設検索のための観光支援システム。

## 使用方法
1. SPARQLエンドポイントにアクセスする(http://dbpedia.org/sparql)
2. 以下の利用シナリオから目的に合うものを選択
3. シナリオに対応するSPARQLクエリをエディタにコピー＆ペースト
4. クエリを実行して結果を取得

## 利用シナリオ

### 利用場面1：近場でのアニメ聖地巡礼＋α

**使用例1**: 東京駅から半径5km圏内のアニメ聖地を近い順で表示し、休憩として周辺500m以内のカフェを近い順で表示

#### 実装詳細
1. アニメ聖地検索クエリ（`near_Animespot`）（`near_Animespot_Details`）（`near_Animespot_All`）
   - 東京駅の座標を基準点として設定
   - HAVING句による5km圏内のフィルタリング
   - 距離順でのソート
   - 3つファイルはそれぞれ焦点が異なり,near_Animespotは詳細情報,near_Animetion_Timeはシーンの時間が含まる聖地情報を表示し,near_Animespot_Allはすべての聖地情報が表示される.

  | フィールド | 説明 |
|------------|------|
| 聖地名     | 聖地として登録された場所の名称 |
| アニメ名   | 関連するアニメ作品のタイトル |
| 詳細情報   | 聖地に関する具体的な説明 |
| エピソード | 関連するアニメのエピソード番号 |
| 時間       | シーンの時間情報|
| 住所       | 聖地の所在地 |
| 緯度経度   | 位置情報の座標 |
     

2. カフェ検索クエリ（`near_cafe`）
   - 選択した聖地(東京駅)の座標を基準点として設定
   - 500m圏内のカフェを検索
   - 距離順でのソート

| フィールド | 説明 |
|------------|------|
| 店名       | カフェの名称 |
| 住所       | カフェの所在地 |

#### カスタマイズ方法：

1. 現在地の変更

   使用例では,「アニメ聖地検索」「カフェ検索」共に現在地として「東京駅」を設定したが,以下を変更することで任意の場所を中心に検索可能
    - 変更箇所: BIND(35.6812362 AS ?tokyo_lat) BIND(139.7671248 AS ?tokyo_long)
  　
   - 渋谷駅(35.6580,139.7016)に書き換え

2. 検索範囲の変更

   クエリ内の数値を変更することで、検索範囲を広げる,狭めるなどの調整可能
    - 変更箇所: HAVING(?dist < 0.005)
    - 数値を変更することで検索範囲を調整可能（0.005 = 約500m）

3.施設カテゴリの変更(category)

　上記の使用例では＋αの部分を,休憩を想定した任意の聖地中心のカフェ検索としたが,施設カテゴリ一覧のクエリ(category)を参考に変更可能
　 - 変更箇所: ?type rdfs:label "カフェ"

     
### 利用場面2：休日で友人たちとの好きなアニメの聖地巡礼＋α

**使用例１**: 複数のアニメ作品の聖地が集中するエリアを一覧で表示し、選択したエリア内(ここでは例として尼崎市)の銭湯を検索

#### 実装詳細
1. エリア検索クエリ（`area_anime_spot`）
   - 市区町村単位での聖地集計
   - アニメ作品ごとの聖地数カウント
   - エリアごとの総聖地数算出

| フィールド | 説明 |
|------------|------|
| 市区町村   | 行政区分 |
| アニメ(聖地数)    | 作品名と作品ごとの聖地数 |
| 聖地数     | エリア内の総聖地数 |

2. 銭湯検索クエリ（`sento_serch`）
   - 選択したエリア内(尼崎市)の銭湯を検索
  
| フィールド | 説明 |
|------------|------|
| 銭湯名     | 施設の名称 |
| 住所       | 施設の所在地 |

#### カスタマイズ方法：

1.施設カテゴリの変更(category)

　上記の使用例では＋αの部分を,休憩を想定して尼崎市の銭湯を検索としたが,施設カテゴリ一覧のクエリ(category)を参考に変更可能
　 - 変更箇所: ?type rdfs:label "銭湯"

**使用例2:「けいおん」(好きなアニメ)の聖地を都道府県別に表示し、目的地を決定する.加えて,に位置の聖地から周辺600mの居酒屋を近い順で表示する**

#### 実装詳細
1. エリア検索クエリ（`Animespot_count`）
   - アニメ作品の都道府県単位での聖地分布
   - アニメ名の部分一致検索
     
| フィールド | 説明 |
|------------|------|
| アニメ名  | 作品タイトル |
| 都道府県  | 聖地が存在する地域 |
| アニメ(聖地数)    | 各都道府県における聖地数 |

2. 特定アニメ聖地検索（`Animespot_List`）（`Animespot_List1`）（`Animespot_List2`）（`Animespot_List3`）
   - 特定のアニメ作品(けいおん)の聖地一覧(Animespot_List)
   - アニメ名の部分一致検索
   - 任意の都道府県でフィルタリング
   - Animespot_List1は一つの都道府県でフィルタリング,Animespot_List2は二つの都道府県でフィルタリング,Animespot_List3は三つの都道府県でフィルタリングする
     
| フィールド | 説明 |
|------------|------|
| 聖地名  | アニメの聖地 |
| アニメ名  | 作品タイトル |
| 詳細コメント   | 聖地に関する具体的な説明 |
| エピソード | 関連するアニメのエピソード番号 |
| 時間       | シーンの時間情報|
| 都道府県  | 聖地が存在する地域 |
| 住所    | 聖地の所在地 |
| 緯度経度    | 聖地の座標 |

3. 周辺居酒屋検索クエリ（`near_izakaya`）
   - 選択した聖地の座標を基準地点として設定
   - 600m圏内の居酒屋を検索
   - 距離順でのソート
  
| フィールド | 説明 |
|------------|------|
| 店舗名     | 居酒屋の名称 |
| 住所       | 店舗の所在地 |
| 緯度経度       | 店舗の座標 |

#### カスタマイズ方法：

1.施設カテゴリの変更(category)

　上記の使用例では居酒屋カテゴリで検索したが、施設カテゴリ一覧のクエリ(category)を参考に変更可能
　 - 変更箇所: FILTER(?type_label = "居酒屋")
  
2. 現在地の変更

   「周辺居酒屋検索」では以下の緯度経度を変更することで任意の場所を基準地点とすることが可能(緯度経度は上記のアニメ聖地検索から参照)
    - 変更箇所: BIND(35.6812362 AS ?target_lat) BIND(139.7671248 AS ?target_long)


3. 検索範囲の変更

   クエリ内の数値を変更することで、検索範囲を広げる,狭めるなどの調整可能
    - 変更箇所: HAVING(?dist < 0.001)
    - 数値を変更することで検索範囲を調整可能（0.005 = 約500m）

4. アニメ作品の変更

   「エリア検索クエリ」の以下の部分を変更することで任意のアニメ聖地で検索可能。アニメ一覧のクエリ(Anime_List)を参照。
    - 変更箇所(部分一致を採用): FILTER(CONTAINS(LCASE(str(?anime_title)), LCASE("けいおん")))
   


### 利用場面3：特定カテゴリの聖地をベースにした関連スポット巡り＋α

**使用例**: カテゴリが「神社」のアニメ聖地を検索し,その聖地周辺に存在する他の神社を近い順で表示する

#### 実装詳細
1. 神社カテゴリのアニメ聖地検索クエリ（`shrine_Animespot`）（`shrine_Animespot_Details`）（`shrine_Animespot_All`）
   - カテゴリ「神社」でフィルタリング
   - 3つファイルはそれぞれ焦点が異なり,shrine_Animespotはコメント有の聖地情報,shrine_Animetion_Detailsはシーンのエピソードや時間を含めた聖地情報を表示し,shrine_Animespot_Allはすべての聖地情報が表示される.

  | フィールド | 説明 |
|------------|------|
| 聖地名     | 聖地として登録された場所の名称 |
| アニメ名   | 関連するアニメ作品のタイトル |
| 詳細コメント   | 聖地に関する具体的な説明 |
| エピソード | 関連するアニメのエピソード番号 |
| 時間       | シーンの時間情報|
| 都道府県   | 行政区分 |
| 市区町村   | 行政区分 |
| 住所       | 聖地の所在地 |
| 緯度経度   | 位置情報の座標 |

2. 周辺神社検索クエリ（`near_shrine`）
   - 選択した聖地の座標を基準点として設定
   - 1m圏内の神社を検索
   - 距離順でのソート

| フィールド | 説明 |
|------------|------|
| 神社名      | 神社の名称 |
| アニメ      | アニメのタイトル |
| 住所      | 神社の所在地 |
| 緯度経度      | 神社の緯度経度 |

#### カスタマイズ方法：

1.施設カテゴリの変更(category)

　上記の使用例では神社カテゴリのみのスポットを検索したが、施設カテゴリ一覧のクエリ(category)を参考に変更可能
　 - 変更箇所: FILTER(?type_label = "神社")
2. 現在地の変更

   「周辺神社検索」では以下の緯度経度を変更することで任意の場所を基準地点とすることが可能(緯度経度は上記のアニメ聖地検索から参照)
    - 変更箇所: BIND(35.6812362 AS ?target_lat) BIND(139.7671248 AS ?target_long)


3. 検索範囲の変更

   クエリ内の数値を変更することで、検索範囲を広げる,狭めるなどの調整可能
    - 変更箇所: HAVING(?dist < 0.001)
    - 数値を変更することで検索範囲を調整可能（0.005 = 約500m）


### 利用場面4：放送時期に合わせた聖地巡礼

**使用例**:  2016年放送アニメの一覧を表示し、選択したアニメの聖地情報を取得して巡礼する

#### 実装詳細
1. 指定した放送年のアニメ一覧クエリ（`Animespot_Data`）（`Animespot_Data_range`）
   - Wikidataとの連携による放送日情報の取得
   - 2016年単位でのフィルタリング
   - Animespot_Data_rangeは、2014~2017年など複数年でのフィルタリング
   - アニメごとの聖地数のカウント

| フィールド | 説明 |
|------------|------|
| アニメ名  | 作品タイトル |
| 放送年   | 指定した放送年 |
| 聖地数 | アニメの聖地数 |     

2. 特定アニメ聖地検索（`Animespot_List`）（`Animespot_List1`）（`Animespot_List2`）（`Animespot_List3`）
   - 特定のアニメ作品の聖地一覧(Animespot_List)
   - アニメ名の部分一致検索
   - 任意の都道府県でフィルタリング
   - Animespot_List1は一つの都道府県でフィルタリング,Animespot_List2は二つの都道府県でフィルタリング,Animespot_List3は三つの都道府県でフィルタリングする
     
| フィールド | 説明 |
|------------|------|
| 聖地名  | アニメの聖地 |
| アニメ名  | 作品タイトル |
| 詳細コメント   | 聖地に関する具体的な説明 |
| エピソード | 関連するアニメのエピソード番号 |
| 時間       | シーンの時間情報|
| 都道府県  | 聖地が存在する地域 |
| 住所    | 聖地の所在地 |
| 緯度経度    | 聖地の座標 |
 
#### カスタマイズ方法：

1.放送年の変更(category)

　上記の使用例では2016年や2014~2017年での検索であったが，以下の部分に任意の数字を入力可能
　 - 変更箇所: FILTER(YEAR(xsd:dateTime(?start)) = 2016)

2. アニメの変更

   以下の部分を変更することで任意のアニメ聖地で検索可能。アニメ一覧のクエリ(Anime_List)を参照。
    - 変更箇所(部分一致を採用): FILTER(CONTAINS(LCASE(str(?anime_title)), LCASE("けいおん")))
  
### 利用場面5：アニメのジャンルに特化した聖地巡礼

**使用例**:  SFアニメの一覧を表示し、そこから好きなアニメを選び聖地巡礼する

#### 実装詳細
1. ジャンル一覧クエリ（`Anime_genreList`）
   - Wikidataとの連携によるジャンル情報の取得

| フィールド | 説明 |
|------------|------|
| ジャンル  | アニメのジャンル |

2. 指定したジャンルのアニメ一覧クエリ（`Anime_genreList`）
   - Wikidataとの連携によるジャンル情報の取得
  
| フィールド | 説明 |
|------------|------|
| アニメ名  | 作品タイトル |
| ジャンル   | 指定したジャンル |
| 聖地数 | アニメの聖地数 |  

3. 特定アニメ聖地検索（`Animespot_List`）（`Animespot_List1`）（`Animespot_List2`）（`Animespot_List3`）
   - 特定のアニメ作品の聖地一覧(Animespot_List)
   - アニメ名の部分一致検索
   - 任意の都道府県でフィルタリング
   - Animespot_List1は一つの都道府県でフィルタリング,Animespot_List2は二つの都道府県でフィルタリング,Animespot_List3は三つの都道府県でフィルタリングする
     
| フィールド | 説明 |
|------------|------|
| 聖地名  | アニメの聖地 |
| アニメ名  | 作品タイトル |
| 詳細コメント   | 聖地に関する具体的な説明 |
| エピソード | 関連するアニメのエピソード番号 |
| 時間       | シーンの時間情報|
| 都道府県  | 聖地が存在する地域 |
| 住所    | 聖地の所在地 |
| 緯度経度    | 聖地の座標 |
 
#### カスタマイズ方法：

1.ジャンルの変更(category)

　上記の使用例ではSFでの部分検索であったが，以下の部分に任意のジャンルを入力可能
　 - 変更箇所: FILTER(CONTAINS(?genre_Label, "SF"))

2. アニメの変更

   以下の部分を変更することで任意のアニメ聖地で検索可能。アニメ一覧のクエリ(Anime_List)を参照。
    - 変更箇所(部分一致を採用): FILTER(CONTAINS(LCASE(str(?anime_title)), LCASE("けいおん")))
